+ train
++ model_dir
++ local dir=out-final/ExtraTrees
++ mkdir -p out-final/ExtraTrees
++ printf out-final/ExtraTrees
+ python -m rubric_llm_judge.label train --qrel /home/ben/rubric-llm-judge/LLMJudge/data/llm4eval_dev_qrel_2024.txt --judgements /home/dietz/jelly-home/peanut-jupyter/exampp/data/llmjudge/all-llmjudge-passages_dev.json.gz --classifier ExtraTrees --restarts 5 --output out-final/ExtraTrees/model
[nltk_data] Downloading package stopwords to /home/ben/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package punkt to /home/ben/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (3653, 429)
INFO:root:training score: 0.6159321105940323
INFO:root:Train set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1380  134  198  246]
 [ 294  319  211  108]
 [  62   22  276   54]
 [  42    2   30  275]]
INFO:root:Train kappa=0.423111669509184
INFO:root:Validation set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1855  299  328   98]
 [ 216   50  184   21]
 [  58   40  103   10]
 [ 103   72  141   32]]
INFO:root:Validation kappa=0.17149366344753192
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (3653, 429)
INFO:root:training score: 0.6181220914316999
INFO:root:Train set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1368  152  189  249]
 [ 290  338  197  107]
 [  65   13  279   57]
 [  40    4   32  273]]
INFO:root:Train kappa=0.42690525226218434
INFO:root:Validation set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1815  306  345  114]
 [ 216   56  177   22]
 [  57   38  105   11]
 [ 103   67  142   36]]
INFO:root:Validation kappa=0.16797482339163072
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (3653, 429)
INFO:root:training score: 0.6129208869422392
INFO:root:Train set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1369  145  194  250]
 [ 293  309  224  106]
 [  65   10  286   53]
 [  36   10   28  275]]
INFO:root:Train kappa=0.42020578693967836
INFO:root:Validation set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1822  290  367  101]
 [ 217   47  182   25]
 [  61   40   99   11]
 [ 100   64  149   35]]
INFO:root:Validation kappa=0.1617105222469447
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (3653, 429)
INFO:root:training score: 0.6200383246646591
INFO:root:Train set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1370  141  200  247]
 [ 272  333  227  100]
 [  59   17  286   52]
 [  36    8   29  276]]
INFO:root:Train kappa=0.4325615978992633
INFO:root:Validation set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1887  270  320  103]
 [ 223   46  178   24]
 [  59   36  106   10]
 [ 105   66  142   35]]
INFO:root:Validation kappa=0.1786509930321848
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (3653, 429)
INFO:root:training score: 0.61456337257049
INFO:root:Train set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1347  162  193  256]
 [ 294  332  204  102]
 [  62   11  289   52]
 [  38    5   29  277]]
INFO:root:Train kappa=0.4236697033471464
INFO:root:Validation set prediction
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[1854  280  348   98]
 [ 214   51  185   21]
 [  58   43  101    9]
 [ 108   66  139   35]]
INFO:root:Validation kappa=0.17207559426092633
INFO:root:Best model: train kappa=0.4325615978992633, validation kappa=0.1786509930321848
Method.ExtraTrees 0 0.423111669509184 0.17149366344753192
Method.ExtraTrees 1 0.42690525226218434 0.16797482339163072
Method.ExtraTrees 2 0.42020578693967836 0.1617105222469447
Method.ExtraTrees 3 0.4325615978992633 0.1786509930321848
Method.ExtraTrees 4 0.4236697033471464 0.17207559426092633
+ predict
++ model_dir
++ local dir=out-final/ExtraTrees
++ mkdir -p out-final/ExtraTrees
++ printf out-final/ExtraTrees
++ model_dir
++ local dir=out-final/ExtraTrees
++ mkdir -p out-final/ExtraTrees
++ printf out-final/ExtraTrees
++ model_dir
++ local dir=out-final/ExtraTrees
++ mkdir -p out-final/ExtraTrees
++ printf out-final/ExtraTrees
+ python -m rubric_llm_judge.label predict --model out-final/ExtraTrees/model --qrel /home/ben/rubric-llm-judge/LLMJudge/data/llm4eval_dev_qrel_2024.txt --judgements /home/dietz/jelly-home/peanut-jupyter/exampp/data/llmjudge/all-llmjudge-passages_dev.json.gz --output out-final/ExtraTrees/dev.jsonl.gz --output-qrel out-final/ExtraTrees/dev.qrel
[nltk_data] Downloading package stopwords to /home/ben/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package punkt to /home/ben/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (7263, 429)
INFO:root:[[3257  411  520  350]
 [ 495  379  405  124]
 [ 118   53  392   62]
 [ 141   74  171  311]]
INFO:root:Kappa=0.3309563399876524
+ test
++ model_dir
++ local dir=out-final/ExtraTrees
++ mkdir -p out-final/ExtraTrees
++ printf out-final/ExtraTrees
++ model_dir
++ local dir=out-final/ExtraTrees
++ mkdir -p out-final/ExtraTrees
++ printf out-final/ExtraTrees
++ model_dir
++ local dir=out-final/ExtraTrees
++ mkdir -p out-final/ExtraTrees
++ printf out-final/ExtraTrees
+ python -m rubric_llm_judge.label predict -m out-final/ExtraTrees/model --qrel /home/ben/rubric-llm-judge/LLMJudge/data/llm4eval_test_qrel_2024.txt -j /home/dietz/jelly-home/peanut-jupyter/exampp/data/llmjudge/nuggets-explain--nuggets-rate--all-llmjudge-passages_test.json.gz -o out-final/ExtraTrees/test.jsonl.gz --output-qrel out-final/ExtraTrees/test.qrel
[nltk_data] Downloading package stopwords to /home/ben/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package punkt to /home/ben/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
INFO:root:Using prompt classes NuggetSelfRatedPrompt,QuestionSelfRatedUnanswerablePromptWithChoices,FagB,FagB_few,HELM,Sun,Sun_few,Thomas
INFO:root:feature shape: (4423, 205)
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ben/rubric-llm-judge/rubric_llm_judge/label.py", line 559, in <module>
    main()
  File "/home/ben/rubric-llm-judge/rubric_llm_judge/label.py", line 547, in main
    kappa = predict(clf=clf,
            ^^^^^^^^^^^^^^^^
  File "/home/ben/rubric-llm-judge/rubric_llm_judge/label.py", line 408, in predict
    y = clf.predict(X)
        ^^^^^^^^^^^^^^
  File "/nix/store/l3kszw083nipdrk31n3jykkgwmiczxql-python3-3.11.6-env/lib/python3.11/site-packages/sklearn/pipeline.py", line 507, in predict
    Xt = transform.transform(Xt)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/nix/store/l3kszw083nipdrk31n3jykkgwmiczxql-python3-3.11.6-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 140, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nix/store/l3kszw083nipdrk31n3jykkgwmiczxql-python3-3.11.6-env/lib/python3.11/site-packages/sklearn/preprocessing/_data.py", line 1004, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "/nix/store/l3kszw083nipdrk31n3jykkgwmiczxql-python3-3.11.6-env/lib/python3.11/site-packages/sklearn/base.py", line 625, in _validate_data
    self._check_n_features(X, reset=reset)
  File "/nix/store/l3kszw083nipdrk31n3jykkgwmiczxql-python3-3.11.6-env/lib/python3.11/site-packages/sklearn/base.py", line 414, in _check_n_features
    raise ValueError(
ValueError: X has 205 features, but StandardScaler is expecting 429 features as input.
